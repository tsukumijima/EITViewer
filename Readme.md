
# EITViewer

æ”¾é€æ³¢ã® MPEG2-TS ã«é‡ç•³ã•ã‚Œã¦ã„ã‚‹ EIT (Event Information Table: ç•ªçµ„æƒ…å ±) ã®ç”Ÿãƒ‡ãƒ¼ã‚¿ã‚’æ™‚ç³»åˆ—ã§ã„ã„æ„Ÿã˜ã«è¡¨ç¤ºã™ã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚  
[@chinachu/node-aribts](https://github.com/Chinachu/node-aribts/tree/v1-for-mirakurun) ã‹ã‚‰å–å¾—ã—ãŸ EIT ã®æƒ…å ±ã‚’ã€æ–‡å­—åˆ—ã‚„æ™‚åˆ»ã‚’ human-readable ãªå½¢ã«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã—ãŸä¸Šã§ã€TOT (Time Offset Table: æ™‚åˆ»æƒ…å ±) ã¨ä¸€ç·’ã«å‡ºåŠ›ã—ã¾ã™ã€‚

## Usage

```bash
Usage: EITViewer [options]

Options:
  --input <path>               å…¥åŠ›ã® TS ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹
  --output-log <path>          å‡ºåŠ›ã™ã‚‹ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ (çœç•¥æ™‚ã¯ stdout ã«å‡ºåŠ›)
  --eit-types <eit_types>      çµã‚Šè¾¼ã‚€ EIT ã®ã‚¿ã‚¤ãƒ— (ã‚³ãƒ³ãƒåŒºåˆ‡ã‚Šã€present/following/schedule ã‹ã‚‰é¸æŠ)
  --service-ids <service_ids>  çµã‚Šè¾¼ã‚€ã‚µãƒ¼ãƒ“ã‚¹ ID ã®ãƒªã‚¹ãƒˆ (ã‚³ãƒ³ãƒåŒºåˆ‡ã‚Š)
  --event-ids <event_ids>      çµã‚Šè¾¼ã‚€ã‚¤ãƒ™ãƒ³ãƒˆ ID ã®ãƒªã‚¹ãƒˆ (ã‚³ãƒ³ãƒåŒºåˆ‡ã‚Š)
  -h, --help                   display help for command
```

`--eit-types` / `--service-ids` / `--event-ids` ã®3ã¤ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã—ã¦ã€è¡¨ç¤ºã™ã‚‹ EIT ã‚’çµã‚Šè¾¼ã‚ã¾ã™ã€‚

ä»¥ä¸‹ã¯ã€EIT: `EIT[present] & EIT[following]` / service_id: `1032 (NHKEãƒ†ãƒ¬1æ±äº¬)` / event_id: `24177,24185,24188,65522` ã®æ¡ä»¶ã«ä¸€è‡´ã™ã‚‹ EIT ã‚’è¡¨ç¤ºã™ã‚‹å ´åˆã®ã‚³ãƒãƒ³ãƒ‰ä¾‹ã§ã™ã€‚

```bash
$ ./EITViewer --input /path/to/record.ts --output-log /path/to/log.txt --eit-types present,following --service-ids 1032 --event-ids 24177,24185,24188,65522
```

> Tips: TOT ã¯åŸºæœ¬5ç§’ãŠãã«é€å‡ºã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€EIT ãŒé€å‡ºã•ã‚ŒãŸæ™‚åˆ»ã¯ã€(ãã® EIT ã®ç›´å‰ã® TOT ã® JST_Time ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹æ™‚åˆ») ï½ (ãã® EIT ã®ç›´å‰ã® TOT ã® JST_Time ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹æ™‚åˆ» + 5 ç§’) ã®é–“ã«ãªã‚Šã¾ã™ã€‚  
> ãŸã¨ãˆã°ã€ç›®å½“ã¦ã® EIT ã®ç›´å‰ã® TOT ãŒ `2022-08-07T20:06:35+09:00` ãªã‚‰ã€ç›®å½“ã¦ã® EIT ã¯ `2022-08-07T20:06:35+09:00` ï½ `2022-08-07T20:06:40+09:00` ã®é–“ã«é€å‡ºã•ã‚ŒãŸã“ã¨ã«ãªã‚Šã¾ã™ã€‚

## Log Sample

```
================================================================================
EIT (Event Information Table) [present] [service_id: 1032]
================================================================================
{ table_id: 78,
  section_syntax_indicator: 1,
  section_length: 152,
  service_id: 1032,
  version_number: 9,
  current_next_indicator: 1,
  section_number: 0,
  last_section_number: 1,
  transport_stream_id: 32737,
  original_network_id: 32737,
  segment_last_section_number: 1,
  last_table_id: 78,
  events:
   [ { event_id: 24188,
       start_time: '2022-08-07T20:05:00+09:00',
       duration: Infinity,
       running_status: 0,
       free_CA_mode: 0,
       descriptors_loop_length: 125,
       descriptors:
        [ { descriptor_tag: 77,
            descriptor_length: 45,
            ISO_639_language_code: 'jpn',
            event_name_length: 21,
            event_name_char: 'ï¼®ï¼¨ï¼«æ‰‹è©±ãƒ‹ãƒ¥ãƒ¼ã‚¹ğŸˆ',
            text_length: 19,
            text_char: 'ã€ã‚­ãƒ£ã‚¹ã‚¿ãƒ¼ã€‘èµ¤å €ä»ç¾' },
          { descriptor_tag: 78,
            descriptor_length: 33,
            descriptor_number: 0,
            last_descriptor_number: 0,
            ISO_639_language_code: '\u0000\u0000\u0000',
            length_of_items: 27,
            items:
             [ { item_description_length: 6,
                 item_description_char: 'å‡ºæ¼”è€…',
                 item_length: 19,
                 item_char: 'ã€ã‚­ãƒ£ã‚¹ã‚¿ãƒ¼ã€‘èµ¤å €ä»ç¾' } ],
            text_length: 0,
            text_char: '' },
          { descriptor_tag: 80,
            descriptor_length: 6,
            stream_content: 1,
            component_type: 179,
            component_tag: 0,
            ISO_639_language_code: 'jpn',
            text_char: '' },
          { descriptor_tag: 84,
            descriptor_length: 4,
            contents:
             [ { content_nibble_level_1: 0,
                 content_nibble_level_2: 0,
                 user_nibble_1: 15,
                 user_nibble_2: 15 },
               { content_nibble_level_1: 11,
                 content_nibble_level_2: 4,
                 user_nibble_1: 15,
                 user_nibble_2: 15 } ] },
          { descriptor_tag: 193,
            descriptor_length: 1,
            digital_recording_control_data: 2,
            maximum_bitrate_flag: 0,
            component_control_flag: 0,
            user_defined: 4 },
          { descriptor_tag: 196,
            descriptor_length: 9,
            stream_content: 2,
            component_type: 1,
            component_tag: 16,
            stream_type: 15,
            simulcast_group_tag: 255,
            ES_multi_lingual_flag: 0,
            main_component_flag: 1,
            quality_indicator: 2,
            sampling_rate: 7,
            ISO_639_language_code: 'jpn',
            text_char: '' },
          { descriptor_tag: 214,
            descriptor_length: 13,
            group_type: 1,
            event_count: 3,
            events:
             [ { service_id: 1032, event_id: 24188 },
               { service_id: 1033, event_id: 24188 },
               { service_id: 1034, event_id: 24188 } ],
            private_data_byte: Buffer [Uint8Array] [] } ] } ],
  CRC_32: Buffer [Uint8Array] [ 104, 49, 205, 147 ] }
================================================================================
EIT (Event Information Table) [following] [service_id: 1032]
================================================================================
{ table_id: 78,
  section_syntax_indicator: 1,
  section_length: 474,
  service_id: 1032,
  version_number: 9,
  current_next_indicator: 1,
  section_number: 1,
  last_section_number: 1,
  transport_stream_id: 32737,
  original_network_id: 32737,
  segment_last_section_number: 1,
  last_table_id: 78,
  events:
   [ { event_id: 24185,
       start_time: '2022-08-07T20:10:00+09:00',
       duration: Infinity,
       running_status: 0,
       free_CA_mode: 0,
       descriptors_loop_length: 447,
       descriptors:
        [ { descriptor_tag: 77,
            descriptor_length: 176,
            ISO_639_language_code: 'jpn',
            event_name_length: 44,
            event_name_char: 'ã‚¢ãƒ‹ãƒ¡ã€€ãƒ©ãƒ–ãƒ©ã‚¤ãƒ–ï¼ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚¹ã‚¿ãƒ¼ï¼ï¼ã€€ï¼’æœŸï¼ˆï¼”ï¼‰ğŸˆ‘',
            text_length: 127,
            text_char:
             'è¡¨å‚é“ã¨åŸå®¿ã¨é’å±±ã€ï¼“ã¤ã®è¡—ã®ã¯ã–ã¾ã«ã‚ã‚‹ç§ç«‹çµãƒ¶ä¸˜å¥³å­é«˜ç­‰å­¦æ ¡ã€‚æ–°å…¥ç”Ÿã‚‚åŠ ã‚ã£ã¦ã€ã‚¹ã‚¯ãƒ¼ãƒ«ã‚¢ã‚¤ãƒ‰ãƒ«ã®å¤§ä¼šã€Œãƒ©ãƒ–ãƒ©ã‚¤ãƒ–ï¼ã€å„ªå‹ã‚’ç›®æŒ‡ã™é’æ˜¥ãƒ‰ãƒ©ãƒãŒå‹•ãã¯ã˜ã‚ã‚‹ã€‚' },
          { descriptor_tag: 78,
            descriptor_length: 105,
            descriptor_number: 0,
            last_descriptor_number: 1,
            ISO_639_language_code: '\u0000\u0000\u0000',
            length_of_items: 99,
            items:
             [ { item_description_length: 8,
                 item_description_char: 'ç•ªçµ„å†…å®¹',
                 item_length: 89,
                 item_char: 'ã€å£°ã€‘ä¼Šé”ã•ã‚†ã‚Šï¼Œï¼¬ï½‰ï½™ï½•ï½•ï¼Œå²¬ãªã“ï¼Œãƒšã‚¤ãƒˆãƒ³å°šæœªï¼Œé’å±±ãªãã•ï¼Œéˆ´åŸå¸Œå®Ÿï¼Œç±”å³¶æœ±éŸ³ï¼Œå¤§ç†Šå’Œå¥ï¼Œçµµæ£®å½©' } ],
            text_length: 0,
            text_char: '' },
          { descriptor_tag: 78,
            descriptor_length: 103,
            descriptor_number: 1,
            last_descriptor_number: 1,
            ISO_639_language_code: '\u0000\u0000\u0000',
            length_of_items: 97,
            items:
             [ { item_description_length: 6,
                 item_description_char: 'å‡ºæ¼”è€…',
                 item_length: 89,
                 item_char: 'ã€å£°ã€‘ä¼Šé”ã•ã‚†ã‚Šï¼Œï¼¬ï½‰ï½™ï½•ï½•ï¼Œå²¬ãªã“ï¼Œãƒšã‚¤ãƒˆãƒ³å°šæœªï¼Œé’å±±ãªãã•ï¼Œéˆ´åŸå¸Œå®Ÿï¼Œç±”å³¶æœ±éŸ³ï¼Œå¤§ç†Šå’Œå¥ï¼Œçµµæ£®å½©' } ],
            text_length: 0,
            text_char: '' },
          { descriptor_tag: 80,
            descriptor_length: 6,
            stream_content: 1,
            component_type: 179,
            component_tag: 0,
            ISO_639_language_code: 'jpn',
            text_char: '' },
          { descriptor_tag: 84,
            descriptor_length: 2,
            contents:
             [ { content_nibble_level_1: 7,
                 content_nibble_level_2: 0,
                 user_nibble_1: 15,
                 user_nibble_2: 15 } ] },
          { descriptor_tag: 193,
            descriptor_length: 1,
            digital_recording_control_data: 2,
            maximum_bitrate_flag: 0,
            component_control_flag: 0,
            user_defined: 4 },
          { descriptor_tag: 196,
            descriptor_length: 9,
            stream_content: 2,
            component_type: 3,
            component_tag: 16,
            stream_type: 15,
            simulcast_group_tag: 255,
            ES_multi_lingual_flag: 0,
            main_component_flag: 1,
            quality_indicator: 2,
            sampling_rate: 7,
            ISO_639_language_code: 'jpn',
            text_char: '' },
          { descriptor_tag: 199,
            descriptor_length: 14,
            data_component_id: 8,
            entry_component: 48,
            selector_length: 5,
            selector_byte: Buffer [Uint8Array] [ 1, 19, 106, 112, 110 ],
            num_of_component_ref: 0,
            component_ref: Buffer [Uint8Array] [],
            ISO_639_language_code: 'jpn',
            text_length: 0,
            text_char: '' },
          { descriptor_tag: 214,
            descriptor_length: 13,
            group_type: 1,
            event_count: 3,
            events:
             [ { service_id: 1032, event_id: 24185 },
               { service_id: 1033, event_id: 24185 },
               { service_id: 1034, event_id: 24185 } ],
            private_data_byte: Buffer [Uint8Array] [] } ] } ],
  CRC_32: Buffer [Uint8Array] [ 61, 132, 71, 193 ] }
================================================================================
EIT (Event Information Table) [present] [service_id: 1032]
================================================================================
{ table_id: 78,
  section_syntax_indicator: 1,
  section_length: 152,
  service_id: 1032,
  version_number: 10,
  current_next_indicator: 1,
  section_number: 0,
  last_section_number: 1,
  transport_stream_id: 32737,
  original_network_id: 32737,
  segment_last_section_number: 1,
  last_table_id: 78,
  events:
   [ { event_id: 24188,
       start_time: '2022-08-07T20:05:00+09:00',
       duration: 300,
       running_status: 0,
       free_CA_mode: 0,
       descriptors_loop_length: 125,
       descriptors:
        [ { descriptor_tag: 77,
            descriptor_length: 45,
            ISO_639_language_code: 'jpn',
            event_name_length: 21,
            event_name_char: 'ï¼®ï¼¨ï¼«æ‰‹è©±ãƒ‹ãƒ¥ãƒ¼ã‚¹ğŸˆ',
            text_length: 19,
            text_char: 'ã€ã‚­ãƒ£ã‚¹ã‚¿ãƒ¼ã€‘èµ¤å €ä»ç¾' },
          { descriptor_tag: 78,
            descriptor_length: 33,
            descriptor_number: 0,
            last_descriptor_number: 0,
            ISO_639_language_code: '\u0000\u0000\u0000',
            length_of_items: 27,
            items:
             [ { item_description_length: 6,
                 item_description_char: 'å‡ºæ¼”è€…',
                 item_length: 19,
                 item_char: 'ã€ã‚­ãƒ£ã‚¹ã‚¿ãƒ¼ã€‘èµ¤å €ä»ç¾' } ],
            text_length: 0,
            text_char: '' },
          { descriptor_tag: 80,
            descriptor_length: 6,
            stream_content: 1,
            component_type: 179,
            component_tag: 0,
            ISO_639_language_code: 'jpn',
            text_char: '' },
          { descriptor_tag: 84,
            descriptor_length: 4,
            contents:
             [ { content_nibble_level_1: 0,
                 content_nibble_level_2: 0,
                 user_nibble_1: 15,
                 user_nibble_2: 15 },
               { content_nibble_level_1: 11,
                 content_nibble_level_2: 4,
                 user_nibble_1: 15,
                 user_nibble_2: 15 } ] },
          { descriptor_tag: 193,
            descriptor_length: 1,
            digital_recording_control_data: 2,
            maximum_bitrate_flag: 0,
            component_control_flag: 0,
            user_defined: 4 },
          { descriptor_tag: 196,
            descriptor_length: 9,
            stream_content: 2,
            component_type: 1,
            component_tag: 16,
            stream_type: 15,
            simulcast_group_tag: 255,
            ES_multi_lingual_flag: 0,
            main_component_flag: 1,
            quality_indicator: 2,
            sampling_rate: 7,
            ISO_639_language_code: 'jpn',
            text_char: '' },
          { descriptor_tag: 214,
            descriptor_length: 13,
            group_type: 1,
            event_count: 3,
            events:
             [ { service_id: 1032, event_id: 24188 },
               { service_id: 1033, event_id: 24188 },
               { service_id: 1034, event_id: 24188 } ],
            private_data_byte: Buffer [Uint8Array] [] } ] } ],
  CRC_32: Buffer [Uint8Array] [ 186, 105, 83, 124 ] }
================================================================================
EIT (Event Information Table) [following] [service_id: 1032]
================================================================================
{ table_id: 78,
  section_syntax_indicator: 1,
  section_length: 474,
  service_id: 1032,
  version_number: 10,
  current_next_indicator: 1,
  section_number: 1,
  last_section_number: 1,
  transport_stream_id: 32737,
  original_network_id: 32737,
  segment_last_section_number: 1,
  last_table_id: 78,
  events:
   [ { event_id: 24185,
       start_time: '2022-08-07T20:10:00+09:00',
       duration: 1500,
       running_status: 0,
       free_CA_mode: 0,
       descriptors_loop_length: 447,
       descriptors:
        [ { descriptor_tag: 77,
            descriptor_length: 176,
            ISO_639_language_code: 'jpn',
            event_name_length: 44,
            event_name_char: 'ã‚¢ãƒ‹ãƒ¡ã€€ãƒ©ãƒ–ãƒ©ã‚¤ãƒ–ï¼ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚¹ã‚¿ãƒ¼ï¼ï¼ã€€ï¼’æœŸï¼ˆï¼”ï¼‰ğŸˆ‘',
            text_length: 127,
            text_char:
             'è¡¨å‚é“ã¨åŸå®¿ã¨é’å±±ã€ï¼“ã¤ã®è¡—ã®ã¯ã–ã¾ã«ã‚ã‚‹ç§ç«‹çµãƒ¶ä¸˜å¥³å­é«˜ç­‰å­¦æ ¡ã€‚æ–°å…¥ç”Ÿã‚‚åŠ ã‚ã£ã¦ã€ã‚¹ã‚¯ãƒ¼ãƒ«ã‚¢ã‚¤ãƒ‰ãƒ«ã®å¤§ä¼šã€Œãƒ©ãƒ–ãƒ©ã‚¤ãƒ–ï¼ã€å„ªå‹ã‚’ç›®æŒ‡ã™é’æ˜¥ãƒ‰ãƒ©ãƒãŒå‹•ãã¯ã˜ã‚ã‚‹ã€‚' },
          { descriptor_tag: 78,
            descriptor_length: 105,
            descriptor_number: 0,
            last_descriptor_number: 1,
            ISO_639_language_code: '\u0000\u0000\u0000',
            length_of_items: 99,
            items:
             [ { item_description_length: 8,
                 item_description_char: 'ç•ªçµ„å†…å®¹',
                 item_length: 89,
                 item_char: 'ã€å£°ã€‘ä¼Šé”ã•ã‚†ã‚Šï¼Œï¼¬ï½‰ï½™ï½•ï½•ï¼Œå²¬ãªã“ï¼Œãƒšã‚¤ãƒˆãƒ³å°šæœªï¼Œé’å±±ãªãã•ï¼Œéˆ´åŸå¸Œå®Ÿï¼Œç±”å³¶æœ±éŸ³ï¼Œå¤§ç†Šå’Œå¥ï¼Œçµµæ£®å½©' } ],
            text_length: 0,
            text_char: '' },
          { descriptor_tag: 78,
            descriptor_length: 103,
            descriptor_number: 1,
            last_descriptor_number: 1,
            ISO_639_language_code: '\u0000\u0000\u0000',
            length_of_items: 97,
            items:
             [ { item_description_length: 6,
                 item_description_char: 'å‡ºæ¼”è€…',
                 item_length: 89,
                 item_char: 'ã€å£°ã€‘ä¼Šé”ã•ã‚†ã‚Šï¼Œï¼¬ï½‰ï½™ï½•ï½•ï¼Œå²¬ãªã“ï¼Œãƒšã‚¤ãƒˆãƒ³å°šæœªï¼Œé’å±±ãªãã•ï¼Œéˆ´åŸå¸Œå®Ÿï¼Œç±”å³¶æœ±éŸ³ï¼Œå¤§ç†Šå’Œå¥ï¼Œçµµæ£®å½©' } ],
            text_length: 0,
            text_char: '' },
          { descriptor_tag: 80,
            descriptor_length: 6,
            stream_content: 1,
            component_type: 179,
            component_tag: 0,
            ISO_639_language_code: 'jpn',
            text_char: '' },
          { descriptor_tag: 84,
            descriptor_length: 2,
            contents:
             [ { content_nibble_level_1: 7,
                 content_nibble_level_2: 0,
                 user_nibble_1: 15,
                 user_nibble_2: 15 } ] },
          { descriptor_tag: 193,
            descriptor_length: 1,
            digital_recording_control_data: 2,
            maximum_bitrate_flag: 0,
            component_control_flag: 0,
            user_defined: 4 },
          { descriptor_tag: 196,
            descriptor_length: 9,
            stream_content: 2,
            component_type: 3,
            component_tag: 16,
            stream_type: 15,
            simulcast_group_tag: 255,
            ES_multi_lingual_flag: 0,
            main_component_flag: 1,
            quality_indicator: 2,
            sampling_rate: 7,
            ISO_639_language_code: 'jpn',
            text_char: '' },
          { descriptor_tag: 199,
            descriptor_length: 14,
            data_component_id: 8,
            entry_component: 48,
            selector_length: 5,
            selector_byte: Buffer [Uint8Array] [ 1, 19, 106, 112, 110 ],
            num_of_component_ref: 0,
            component_ref: Buffer [Uint8Array] [],
            ISO_639_language_code: 'jpn',
            text_length: 0,
            text_char: '' },
          { descriptor_tag: 214,
            descriptor_length: 13,
            group_type: 1,
            event_count: 3,
            events:
             [ { service_id: 1032, event_id: 24185 },
               { service_id: 1033, event_id: 24185 },
               { service_id: 1034, event_id: 24185 } ],
            private_data_byte: Buffer [Uint8Array] [] } ] } ],
  CRC_32: Buffer [Uint8Array] [ 172, 3, 88, 46 ] }
================================================================================
TOT (Time Offset Table)
================================================================================
{ table_id: 115,
  section_syntax_indicator: 0,
  section_length: 11,
  JST_time: '2022-08-07T20:06:40+09:00',
  descriptors_loop_length: 0,
  descriptors: [],
  CRC_32: Buffer [Uint8Array] [ 234, 209, 79, 223 ] }
================================================================================
```
